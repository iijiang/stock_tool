<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Screening & Backtest Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .tab-button {
            flex: 1;
            padding: 15px 30px;
            border: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            cursor: pointer;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .tab-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            box-shadow: 0 4px 12px rgba(245, 87, 108, 0.4);
        }
        
        .toggle-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .toggle-btn {
            padding: 10px 25px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            cursor: pointer;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .toggle-btn.active {
            background: #667eea;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 30px;
        }
        
        .equity-curve-img {
            width: 100%;
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-box h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-box p {
            font-size: 1.8em;
            font-weight: 700;
        }
        
        .positive {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%) !important;
        }
        
        .negative {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%) !important;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 1px;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .rank-badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85em;
        }
        
        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab-button {
                padding: 12px 20px;
                font-size: 1em;
            }
        }
        
        #last-updated {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 20px;
            border-radius: 8px;
            display: inline-block;
        }
        
        .refresh-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            margin-left: 15px;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .refresh-btn:active {
            transform: translateY(0);
        }
        
        .refresh-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìä Stock Screening & Backtest Dashboard</h1>
        <p>Interactive visualization of screening results and backtest performance</p>
        <div id="last-updated" style="margin-top: 15px; font-size: 1em; opacity: 0.95;">
            <strong>Last Updated:</strong> <span id="update-timestamp">Loading...</span>
            <button class="refresh-btn" onclick="refreshDashboard()" id="refresh-btn">üîÑ Refresh Data</button>
        </div>
    </div>
    
    <div class="container">
        <div class="tabs">
            <button class="tab-button active" onclick="openTab('sp500')">S&P 500</button>
            <button class="tab-button" onclick="openTab('midcap')">Mid-Cap</button>
            <button class="tab-button" onclick="openTab('combined')">Combined</button>
        </div>
        
        <!-- S&P 500 Tab -->
        <div id="sp500" class="tab-content active">
            <div class="card">
                <h2>üèÜ S&P 500 Top Ranked Stocks</h2>
                <div id="sp500-ranking-stats" class="stats-grid"></div>
                <div class="chart-container">
                    <canvas id="sp500-ranking-chart"></canvas>
                </div>
                <div id="sp500-ranking-table"></div>
            </div>
            
            <div class="card">
                <h2>üìà S&P 500 Backtest Performance</h2>
                <div id="sp500-backtest-stats" class="stats-grid"></div>
                <img id="sp500-equity-img" src="" class="equity-curve-img" alt="SP500 Equity Curve">
                <div class="chart-container">
                    <canvas id="sp500-monthly-returns"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Mid-Cap Tab -->
        <div id="midcap" class="tab-content">
            <div class="card">
                <h2>üöÄ Mid-Cap Top Ranked Stocks</h2>
                <div id="midcap-ranking-stats" class="stats-grid"></div>
                <div class="chart-container">
                    <canvas id="midcap-ranking-chart"></canvas>
                </div>
                <div id="midcap-ranking-table"></div>
            </div>
            
            <div class="card">
                <h2>üìà Mid-Cap Backtest Performance</h2>
                <div id="midcap-backtest-stats" class="stats-grid"></div>
                <img id="midcap-equity-img" src="" class="equity-curve-img" alt="MidCap Equity Curve">
                <div class="chart-container">
                    <canvas id="midcap-monthly-returns"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Combined Tab -->
        <div id="combined" class="tab-content">
            <div class="card">
                <h2>üåê Combined Universe Backtest</h2>
                <div class="toggle-buttons">
                    <button class="toggle-btn active" onclick="toggleCombinedView(10)">Top 10</button>
                    <button class="toggle-btn" onclick="toggleCombinedView(20)">Top 20</button>
                </div>
                <div id="combined-backtest-stats" class="stats-grid"></div>
                <img id="combined-equity-img" src="" class="equity-curve-img" alt="Combined Equity Curve">
                <div class="chart-container">
                    <canvas id="combined-monthly-returns"></canvas>
                </div>
            </div>
            
            <div class="card">
                <h2>üìä Universe Comparison</h2>
                <div class="chart-container">
                    <canvas id="comparison-chart"></canvas>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Tab switching
        function openTab(tabName) {
            const contents = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-button');
            
            contents.forEach(content => content.classList.remove('active'));
            buttons.forEach(button => button.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
        
        // Global state
        let combinedViewLimit = 10;
        let latestFiles = {};
        let chartInstances = {};
        
        // Find latest files dynamically from manifest
        async function findLatestFiles() {
            try {
                // Try to load manifest.json
                const response = await fetch('manifest.json');
                if (response.ok) {
                    const manifest = await response.json();
                    
                    // Update timestamp display
                    if (manifest.generated) {
                        const timestamp = new Date(manifest.generated);
                        document.getElementById('update-timestamp').textContent = 
                            timestamp.toLocaleString('en-US', { 
                                year: 'numeric', 
                                month: 'short', 
                                day: 'numeric', 
                                hour: '2-digit', 
                                minute: '2-digit',
                                second: '2-digit'
                            });
                    }
                    
                    // Map manifest to latestFiles structure
                    latestFiles = {
                        sp500: {
                            ranking: manifest.files.sp500.ranking,
                            returns: `backtest/${manifest.files.sp500.returns}`,
                            summary: `backtest/${manifest.files.sp500.summary}`,
                            equity: `backtest/${manifest.files.sp500.equity}`
                        },
                        midcap: {
                            ranking: manifest.files.midcap.ranking,
                            returns: `backtest/${manifest.files.midcap.returns}`,
                            summary: `backtest/${manifest.files.midcap.summary}`,
                            equity: `backtest/${manifest.files.midcap.equity}`
                        },
                        combined_top10: {
                            returns: `backtest/${manifest.files.combined_top10.returns}`,
                            summary: `backtest/${manifest.files.combined_top10.summary}`,
                            equity: `backtest/${manifest.files.combined_top10.equity}`
                        },
                        combined_top20: {
                            returns: `backtest/${manifest.files.combined_top20.returns}`,
                            summary: `backtest/${manifest.files.combined_top20.summary}`,
                            equity: `backtest/${manifest.files.combined_top20.equity}`
                        }
                    };
                    
                    console.log('‚úì Loaded file manifest:', manifest.generated);
                } else {
                    // Fallback to hardcoded paths
                    console.warn('No manifest found, using fallback paths');
                    document.getElementById('update-timestamp').textContent = 'Unable to load manifest';
                    
                    latestFiles = {
                        sp500: {
                            ranking: 'sp500_ranking_2026-02-14.csv',
                            returns: 'backtest/sp500_backtest_monthly_returns_2026-02-14.csv',
                            summary: 'backtest/sp500_backtest_summary_2026-02-14.json',
                            equity: 'backtest/sp500_equity_curve_2026-02-14.png'
                        },
                        midcap: {
                            ranking: 'midcap_ranking_2026-02-14.csv',
                            returns: 'backtest/midcap_backtest_monthly_returns_2026-02-14.csv',
                            summary: 'backtest/midcap_backtest_summary_2026-02-14.json',
                            equity: 'backtest/midcap_equity_curve_2026-02-14.png'
                        },
                        combined_top10: {
                            returns: 'backtest/combined_top10_backtest_monthly_returns_2026-02-14.csv',
                            summary: 'backtest/combined_top10_backtest_summary_2026-02-14.json',
                            equity: 'backtest/combined_top10_equity_curve_2026-02-14.png'
                        },
                        combined_top20: {
                            returns: 'backtest/combined_top20_backtest_monthly_returns_2026-02-14.csv',
                            summary: 'backtest/combined_top20_backtest_summary_2026-02-14.json',
                            equity: 'backtest/combined_top20_equity_curve_2026-02-14.png'
                        }
                    };
                }
                
                // Update image sources
                document.getElementById('sp500-equity-img').src = latestFiles.sp500.equity;
                document.getElementById('midcap-equity-img').src = latestFiles.midcap.equity;
                // Set initial combined image to top 10
                document.getElementById('combined-equity-img').src = latestFiles.combined_top10.equity;
            } catch (error) {
                console.error('Error finding latest files:', error);
                document.getElementById('update-timestamp').textContent = 'Error loading data';
            }
        }
        
        // Toggle combined view
        function toggleCombinedView(limit) {
            combinedViewLimit = limit;
            
            // Update button states
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Load the correct dataset based on limit
            const dataKey = limit === 10 ? 'combined_top10' : 'combined_top20';
            const dataFiles = latestFiles[dataKey];
            
            // Update the equity curve image
            document.getElementById('combined-equity-img').src = dataFiles.equity;
            
            // Reload combined backtest data with the selected dataset
            loadBacktestData('combined', dataFiles.returns, dataFiles.summary);
            
            // Update comparison chart to reflect the new selection
            createComparisonChart();
        }
        
        // Refresh dashboard data
        async function refreshDashboard() {
            const btn = document.getElementById('refresh-btn');
            btn.disabled = true;
            btn.textContent = '‚è≥ Refreshing...';
            
            try {
                // Reload manifest and file paths
                await findLatestFiles();
                
                // Reload all data
                await loadData();
                
                btn.textContent = '‚úì Refreshed!';
                setTimeout(() => {
                    btn.textContent = 'üîÑ Refresh Data';
                    btn.disabled = false;
                }, 2000);
            } catch (error) {
                console.error('Refresh failed:', error);
                btn.textContent = '‚ùå Failed';
                setTimeout(() => {
                    btn.textContent = 'üîÑ Refresh Data';
                    btn.disabled = false;
                }, 2000);
            }
        }
        
        // Initialize charts
        const chartConfig = {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'top',
                }
            }
        };
        
        // Load and process data
        async function loadData() {
            // Load S&P 500 data
            await loadRankingData('sp500', latestFiles.sp500.ranking);
            await loadBacktestData('sp500', latestFiles.sp500.returns, latestFiles.sp500.summary);
            
            // Load Mid-Cap data
            await loadRankingData('midcap', latestFiles.midcap.ranking);
            await loadBacktestData('midcap', latestFiles.midcap.returns, latestFiles.midcap.summary);
            
            // Load Combined data (default to top 10)
            const combinedKey = combinedViewLimit === 10 ? 'combined_top10' : 'combined_top20';
            await loadBacktestData('combined', latestFiles[combinedKey].returns, latestFiles[combinedKey].summary);
            
            // Create comparison chart
            await createComparisonChart();
        }
        
        async function loadRankingData(universe, filename) {
            try {
                const response = await fetch(filename);
                const csvText = await response.text();
                const data = Papa.parse(csvText, { header: true, dynamicTyping: true }).data;
                
                // Filter valid rows
                const validData = data.filter(row => row.symbol && row.score);
                const top20 = validData.slice(0, 20);
                
                // Create stats
                const avgMomentum6m = (validData.reduce((sum, row) => sum + (row.momentum_6m || 0), 0) / validData.length * 100).toFixed(2);
                const avgScore = (validData.reduce((sum, row) => sum + (row.score || 0), 0) / validData.length).toFixed(3);
                
                const statsHTML = `
                    <div class="stat-box">
                        <h3>Total Stocks</h3>
                        <p>${validData.length}</p>
                    </div>
                    <div class="stat-box ${avgMomentum6m > 0 ? 'positive' : 'negative'}">
                        <h3>Avg 6M Momentum</h3>
                        <p>${avgMomentum6m}%</p>
                    </div>
                    <div class="stat-box">
                        <h3>Avg Score</h3>
                        <p>${avgScore}</p>
                    </div>
                    <div class="stat-box ${top20[0] && top20[0].score > 0.8 ? 'positive' : ''}">
                        <h3>Top Score</h3>
                        <p>${(top20[0]?.score || 0).toFixed(3)}</p>
                    </div>
                `;
                document.getElementById(`${universe}-ranking-stats`).innerHTML = statsHTML;
                
                // Destroy existing chart if it exists
                const chartKey = `${universe}-ranking`;
                if (chartInstances[chartKey]) {
                    chartInstances[chartKey].destroy();
                }
                
                // Create chart
                const ctx = document.getElementById(`${universe}-ranking-chart`).getContext('2d');
                chartInstances[chartKey] = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: top20.map(row => row.symbol),
                        datasets: [{
                            label: 'Composite Score',
                            data: top20.map(row => row.score),
                            backgroundColor: 'rgba(102, 126, 234, 0.8)',
                            borderColor: 'rgba(102, 126, 234, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        ...chartConfig,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 1
                            }
                        }
                    }
                });
                
                // Create table
                const tableHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Symbol</th>
                                <th>Score</th>
                                <th>6M Mom</th>
                                <th>12M Mom</th>
                                <th>Above MA200</th>
                                <th>Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${top20.map(row => `
                                <tr>
                                    <td><span class="rank-badge">${row.rank}</span></td>
                                    <td><strong>${row.symbol}</strong></td>
                                    <td>${row.score.toFixed(3)}</td>
                                    <td style="color: ${row.momentum_6m > 0 ? '#11998e' : '#eb3349'}">${(row.momentum_6m * 100).toFixed(2)}%</td>
                                    <td style="color: ${row.momentum_12m > 0 ? '#11998e' : '#eb3349'}">${(row.momentum_12m * 100).toFixed(2)}%</td>
                                    <td>${row.above_ma200 === 1 ? '‚úÖ' : '‚ùå'}</td>
                                    <td>$${row.current_price.toFixed(2)}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                document.getElementById(`${universe}-ranking-table`).innerHTML = tableHTML;
                
            } catch (error) {
                console.error(`Error loading ${universe} ranking data:`, error);
            }
        }
        
        async function loadBacktestData(universe, returnsFile, summaryFile) {
            try {
                // Load summary
                const summaryResponse = await fetch(summaryFile);
                const summary = await summaryResponse.json();
                
                const statsHTML = `
                    <div class="stat-box ${summary.cagr > 0 ? 'positive' : 'negative'}">
                        <h3>CAGR</h3>
                        <p>${(summary.cagr * 100).toFixed(2)}%</p>
                    </div>
                    <div class="stat-box ${summary.total_return > 0 ? 'positive' : 'negative'}">
                        <h3>Total Return</h3>
                        <p>${(summary.total_return * 100).toFixed(2)}%</p>
                    </div>
                    <div class="stat-box">
                        <h3>Sharpe Ratio</h3>
                        <p>${summary.sharpe_ratio.toFixed(2)}</p>
                    </div>
                    <div class="stat-box negative">
                        <h3>Max Drawdown</h3>
                        <p>${(summary.max_drawdown * 100).toFixed(2)}%</p>
                    </div>
                    <div class="stat-box">
                        <h3>Win Rate</h3>
                        <p>${(summary.win_rate * 100).toFixed(1)}%</p>
                    </div>
                    <div class="stat-box ${summary.outperformance > 0 ? 'positive' : 'negative'}">
                        <h3>vs SPY</h3>
                        <p>${(summary.outperformance * 100).toFixed(2)}%</p>
                    </div>
                `;
                document.getElementById(`${universe}-backtest-stats`).innerHTML = statsHTML;
                
                // Load returns
                const returnsResponse = await fetch(returnsFile);
                const csvText = await returnsResponse.text();
                const data = Papa.parse(csvText, { header: true, dynamicTyping: true }).data;
                
                const validData = data.filter(row => row.date && row.portfolio_return !== undefined);
                
                // Destroy existing chart if it exists
                const chartKey = `${universe}-monthly-returns`;
                if (chartInstances[chartKey]) {
                    chartInstances[chartKey].destroy();
                }
                
                // Create monthly returns chart
                const ctx = document.getElementById(`${universe}-monthly-returns`).getContext('2d');
                chartInstances[chartKey] = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: validData.map(row => row.date),
                        datasets: [{
                            label: 'Monthly Return',
                            data: validData.map(row => row.portfolio_return * 100),
                            backgroundColor: validData.map(row => 
                                row.portfolio_return > 0 ? 'rgba(17, 153, 142, 0.8)' : 'rgba(235, 51, 73, 0.8)'
                            ),
                            borderWidth: 0
                        }]
                    },
                    options: {
                        ...chartConfig,
                        scales: {
                            x: {
                                display: false
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Return (%)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `Return: ${context.parsed.y.toFixed(2)}%`;
                                    }
                                }
                            }
                        }
                    }
                });
                
            } catch (error) {
                console.error(`Error loading ${universe} backtest data:`, error);
            }
        }
        
        async function createComparisonChart() {
            try {
                const sp500 = await fetch(latestFiles.sp500.summary).then(r => r.json());
                const midcap = await fetch(latestFiles.midcap.summary).then(r => r.json());
                // Use currently selected combined dataset
                const combinedKey = combinedViewLimit === 10 ? 'combined_top10' : 'combined_top20';
                const combined = await fetch(latestFiles[combinedKey].summary).then(r => r.json());
                
                // Destroy existing chart if it exists
                if (chartInstances['comparison']) {
                    chartInstances['comparison'].destroy();
                }
                
                const ctx = document.getElementById('comparison-chart').getContext('2d');
                chartInstances['comparison'] = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['CAGR (%)', 'Total Return (%)', 'Sharpe Ratio', 'Max Drawdown (%)', 'Win Rate (%)'],
                        datasets: [
                            {
                                label: 'S&P 500',
                                data: [
                                    sp500.cagr * 100,
                                    sp500.total_return * 100,
                                    sp500.sharpe_ratio,
                                    sp500.max_drawdown * 100,
                                    sp500.win_rate * 100
                                ],
                                backgroundColor: 'rgba(102, 126, 234, 0.8)',
                                borderColor: 'rgba(102, 126, 234, 1)',
                                borderWidth: 2
                            },
                            {
                                label: 'Mid-Cap',
                                data: [
                                    midcap.cagr * 100,
                                    midcap.total_return * 100,
                                    midcap.sharpe_ratio,
                                    midcap.max_drawdown * 100,
                                    midcap.win_rate * 100
                                ],
                                backgroundColor: 'rgba(245, 87, 108, 0.8)',
                                borderColor: 'rgba(245, 87, 108, 1)',
                                borderWidth: 2
                            },
                            {
                                label: `Combined (Top ${combinedViewLimit})`,
                                data: [
                                    combined.cagr * 100,
                                    combined.total_return * 100,
                                    combined.sharpe_ratio,
                                    combined.max_drawdown * 100,
                                    combined.win_rate * 100
                                ],
                                backgroundColor: 'rgba(17, 153, 142, 0.8)',
                                borderColor: 'rgba(17, 153, 142, 1)',
                                borderWidth: 2
                            }
                        ]
                    },
                    options: {
                        ...chartConfig,
                        scales: {
                            y: {
                                title: {
                                    display: true,
                                    text: 'Value'
                                }
                            }
                        }
                    }
                });
                
            } catch (error) {
                console.error('Error creating comparison chart:', error);
            }
        }
        
        // Load all data on page load
        findLatestFiles().then(() => loadData());
    </script>
</body>
</html>
